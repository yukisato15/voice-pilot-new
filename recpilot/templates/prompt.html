<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>RecPilot Prompt</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@500;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['"Noto Sans JP"', "sans-serif"],
            },
          },
        },
      };
    </script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js" crossorigin="anonymous"></script>
  </head>
  <body class="relative flex min-h-screen flex-col bg-black text-white">
    <!-- Room join panel -->
    <div id="room-join-container" class="absolute left-4 top-4 z-50 max-w-xl rounded-2xl border border-white/15 bg-white/5 p-4 shadow-lg backdrop-blur">
      <form id="room-join-form" class="space-y-3">
        <div class="flex items-center justify-between gap-3">
          <div>
            <p class="text-sm font-semibold text-white">接続先を指定</p>
            <p class="text-[11px] text-white/70">Control画面と同じ「組番号・セッション日（YYYYMMDD）・収録進行者名」を一字一句合わせて入力してください。</p>
          </div>
          <span id="room-join-status" class="text-xs font-semibold text-amber-300">room未設定</span>
        </div>
        <div class="grid grid-cols-1 gap-2 sm:grid-cols-3">
          <input
            id="room-join-group"
            type="text"
            placeholder="組番号（例: 001）"
            class="w-full min-w-[140px] rounded-lg border border-white/15 bg-black/40 px-3 py-2 text-sm text-white placeholder-white/50 focus:border-white focus:outline-none focus:ring-2 focus:ring-indigo-400/50"
          />
          <input
            id="room-join-date"
            type="text"
            inputmode="numeric"
            maxlength="8"
            placeholder="セッション日（YYYYMMDD）"
            class="w-full min-w-[170px] rounded-lg border border-white/15 bg-black/40 px-3 py-2 text-sm text-white placeholder-white/50 focus:border-white focus:outline-none focus:ring-2 focus:ring-indigo-400/50"
          />
          <input
            id="room-join-director"
            type="text"
            placeholder="収録進行者名（例: 佐藤祐貴）"
            class="w-full min-w-[170px] rounded-lg border border-white/15 bg-black/40 px-3 py-2 text-sm text-white placeholder-white/50 focus:border-white focus:outline-none focus:ring-2 focus:ring-indigo-400/50"
          />
        </div>
        <div class="flex items-center justify-between gap-3">
          <p class="text-[11px] text-white/60">
            Control と同じ「組番号・セッション日・収録進行者名」からRoomIDを生成し、そのroomにのみ接続します。
          </p>
          <button
            type="submit"
            class="rounded-lg bg-indigo-500 px-4 py-2 text-xs font-bold text-white shadow hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-indigo-300"
          >
            接続
          </button>
        </div>
      </form>
    </div>
    <button
      id="room-join-reopen"
      class="hidden fixed right-4 top-4 z-40 rounded-lg bg-indigo-600 px-3 py-2 text-xs font-bold text-white shadow-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-300"
      type="button"
    >
      接続先を変更
    </button>
    <!-- 画面注目オーバーレイ (最優先) -->
    <div
      id="screen-attention-overlay"
      class="pointer-events-none fixed inset-0 z-[60] hidden flex flex-col items-center justify-center bg-white"
    >
      <div class="attention-message flex flex-col items-center gap-6">
        <span class="text-9xl">⚠️</span>
        <p class="text-6xl font-black text-amber-600 drop-shadow-lg">画面に注目してください</p>
      </div>
    </div>

    <!-- カウントダウン・通知オーバーレイ (最優先表示) -->
    <div
      id="prompt-overlay"
      class="pointer-events-none fixed inset-0 z-50 hidden flex flex-col items-center justify-center gap-4 bg-black/90"
    >
      <span id="prompt-overlay-value" class="text-8xl font-black tracking-wide text-white drop-shadow-lg"></span>
      <p id="prompt-overlay-note" class="text-2xl font-semibold text-white/90"></p>
    </div>

    <!-- 通知メッセージ (上部中央) -->
    <div
      id="prompt-notice"
      class="pointer-events-none fixed top-6 left-0 right-0 z-40 flex justify-center px-4 hidden"
    >
      <span
        id="prompt-notice-text"
        class="rounded-full bg-white/10 px-5 py-2 text-base font-semibold text-white shadow-lg backdrop-blur"
      ></span>
    </div>

    <!-- テーマ表示エリア (上部 - 強調デザイン) -->
    <header class="border-b-2 border-white/20 bg-gradient-to-br from-white/10 to-white/5 px-6 py-8 backdrop-blur-md">
      <div class="mx-auto max-w-5xl">
        <div class="flex-1 min-w-0">
          <!-- テーマラベル -->
          <div class="mb-3">
            <p id="theme-category" class="text-sm font-black uppercase tracking-[0.3em] text-indigo-300">
              テーマ
            </p>
          </div>
          <!-- テーマタイトル (グラデーション枠) -->
          <div class="relative rounded-2xl border-2 border-transparent bg-gradient-to-r from-indigo-500/30 via-purple-500/30 to-pink-500/30 p-[2px] shadow-xl">
            <div class="rounded-xl bg-black/80 px-6 py-4 backdrop-blur-sm">
              <h1 id="theme-title" class="text-3xl font-black leading-tight text-white sm:text-4xl md:text-5xl">
                テーマを読み込み中...
              </h1>
            </div>
          </div>
        </div>
        <!-- ヒント -->
        <ul id="theme-hints" class="mt-5 flex flex-wrap gap-3"></ul>
        <p
          id="prompt-advisory"
          class="mt-4 hidden text-sm font-bold text-red-400"
        ></p>
      </div>
    </header>

    <!-- カンペ表示エリア (中央 - 最大サイズ) -->
    <main class="flex flex-1 flex-col items-center justify-center px-8 py-12">
      <div class="w-full max-w-6xl">
        <div class="relative rounded-3xl border-2 border-white/20 bg-white/5 px-8 py-16 text-center shadow-2xl backdrop-blur-md sm:px-12 sm:py-20">
          <p class="absolute left-6 top-4 text-xs font-bold uppercase tracking-widest text-slate-400">メッセージボード</p>
          <p id="prompt-text" class="text-4xl font-black leading-tight text-white sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl">
            カンペがここに表示されます
          </p>
        </div>
      </div>
      <!-- タイムコード (最下部) -->
      <div class="mt-6 flex items-center gap-6 text-sm">
        <span id="time-elapsed" class="font-mono text-slate-500">経過 --:--:--</span>
        <span class="text-slate-600">•</span>
        <span id="time-remaining" class="font-mono text-2xl font-bold text-amber-400">残り --:--:--</span>
      </div>
    </main>

    <!-- リアクション表示エリア (下部固定 - 文字と被らない) -->
    <div
      id="reaction-display"
      class="pointer-events-none fixed bottom-0 left-0 right-0 z-30 hidden pb-12"
    >
      <div class="reaction-container flex flex-col items-center gap-3">
        <div id="reaction-emoji" class="reaction-emoji text-[8rem] drop-shadow-2xl"></div>
        <div id="reaction-label" class="reaction-label rounded-full bg-white px-6 py-2 text-2xl font-bold text-black shadow-2xl"></div>
      </div>
    </div>

    <script src="{{ url_for('static', filename='js/prompt.js') }}"></script>
  </body>
</html>
